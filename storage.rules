rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
  
    // Helper function to check if a user is authenticated.
    function isAuthenticated() {
      return request.auth != null;
    }
    
    // Admins can read/write anything.
    match /{allPaths=**} {
      allow read, write: if request.auth.token.email in ['admin@careercraft.ai', 'hitarth0236@gmail.com'];
    }

    // Any authenticated user can upload files.
    // This is permissive for development but should be locked down further
    // in production using custom claims or more specific path checks.
    match /{allPaths=**} {
      allow write: if isAuthenticated();
    }
    
    // Allow public read access to all files.
    // This is useful for avatars, payment QR codes, etc.
    allow read: if true;
  }
}
